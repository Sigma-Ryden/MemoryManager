Менеджер памяти состоит с указатель на таблицу сегментов и размера памяти в байтах. Таблица сегментов в свою очередь состоит с указателя на корневой сегмент и счётчика сегментов, включая корневой. Корневой сегмент может сужаться и расширяться при добавлении и удалении пользовательских сегментов соответственно.

Сегмент включает в себя адресс памяти для импользования, размер используемой памяти в байтах и флаг для идентификации состояния сегмента - 'используется' или 'не используется'.

По умолчанию корневой сегмент помечен как 'не используемый' - это сделано для того, чтобы его можно было модифицировать.

Корневой сегмент, по мимо того, что является в качестве свободного пространства - он хранит в себе список сегментов, которые есть в таблице. Адресс для использования нового сегмента вычисляется путём нахождения разницы между запрашиваемым и свободным пространством. Это смещение прибавляется к адрсесу корневого сегмента, и размер корневого сегмента уменьшается на размер сегмента на стеке и на размер запрашиваемого пространства. Таким образом максимальное использование памяти в худшем случае равно 1/3, где 2/3 - пространство для хранения таблицы сегментов. Такое возможно, если постоянно запрашивать сегменты размером 1 байт. Следовательно запрашивая 1 байт, мы запрашиваем в лучшем случае <1> байт, в худшем <1 + размер сегмента на стеке> байт. Лучший случай тот, когда запрашиваемый размер равен сегменту, который свободный. Тогда мы просто перезаписываем состояние сегмента как 'используемый'. Худший случай тот, когда запрашиваемый размер меньше размера найденного сегмента.

Когда мы добавляем сегмент в таблицу, мы ищем 'не используемый' сегмент:
если размер запрашиваемого пространства больше, то возращаем нулевой указатель,
если размер запрашиваемого пространства равен доступному, и нашли 'не используемый сегмент' - выбираем его,
если размер запрашиваемого пространства строго меньше, и нашли 'не используемый' сегмент - выбираем его.

Выбранный сегмент, размер которого равен запрашиваемого, помечается как 'используемый' и возращается с функции.
Выбраный сегмент, размер которого больше запрашиваемого пространству разбивяется на два. Первый сегмент.
